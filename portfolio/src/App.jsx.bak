import React, { useState, useEffect, useRef } from "react";
import "@fontsource/inter";
import { FaUser, FaFileAlt, FaLink, FaReact, FaFigma, FaNodeJs, FaJs, FaGitAlt, FaDatabase, FaTools, FaArrowLeft, FaMapMarkedAlt, FaTag, FaTasks, FaUniversalAccess, FaExternalLinkAlt, FaUsers, FaShoppingCart, FaStar, FaVial, FaCommentDots, FaMousePointer, FaSearchPlus, FaGithub, FaShareAlt, FaPalette, FaLinkedin, FaInstagram, FaTimes, FaChevronDown, FaPlus, FaBars } from "react-icons/fa";
import { FiSun, FiMoon } from "react-icons/fi";
import { SiTailwindcss, SiSketch, SiCanva, SiInkscape, SiGmail } from 'react-icons/si';
import { VscFileCode, VscSymbolFile } from 'react-icons/vsc';
import { GoCheck } from 'react-icons/go';
import { BsArrowRight, BsDiagram3, BsGrid1X2, BsPuzzle } from 'react-icons/bs';
import { motion, AnimatePresence, useAnimation } from "framer-motion";
import { useTheme } from "./hooks/useTheme";

const figmaColors = [
  "#F24E1E", // orange
  "#FF7262", // pink
  "#A259FF", // purple
  "#1ABCFE", // blue
  "#0ACF83", // green
];

const projects = [
  {
    title: "City Issue Reporter (Lokally)",
    thumbnail: "/lokallylp.png",
    description: "Web UI/UX Design Â· Hackathon Project.",
    tech: ["Figma", "React", "Tailwind CSS"],
    tags: ["UI", "Web"],
    colors: ["#2D89DA", "#202020", "#D9D9D9", "#F6554F"],
    caseStudy: {
      heroImage: "/locallyhome.png",
      showcaseImages: [
        "/lokallylp.png",
        "/locallyhome.png",
        "/lokally3.png",
        "/lokally4.png",
      ],
      overview: `Lokally is a civic-tech web platform that enables citizens to report local issues like potholes, broken streetlights, or garbage dumps directly to the municipal body. Designed during a civic innovation hackathon, Lokally simplifies the process of submitting, tracking, and prioritizing public problems â€” bringing accountability and transparency to urban governance.
<br />
<br />
ðŸ›  Tools: Figma, React, Tailwind CSS  <br />
ðŸŽ¨ Roles: UI/UX Design, Ideation.`,
      goal: "To simplify the citizen-to-municipality communication loop with an intuitive dashboard UI.",
      designProcess: `A 7-step process was followed to take the project from ideation to a functional prototype, focusing on user needs and rapid iteration.`,
      designSystem: "Comprehensive design system with color palette, typography, and components."
    },
    x: 100,
    y: 100,
  },
  {
    title: "FarmEazyy",
    thumbnail: "/Farmeazyy1.png",
    description: "Web Platform for Farmers and Buyers",
    tech: ["React Native", "Figma"],
    tags: ["AgriTech", "UI", "Web", "live"],
    colors: ["#32A071", "#FFFFFF", "#A6A6A6", "#36BB11"],
    links: {
      live: "https://farmeazyy.vercel.app/",
      figma: "https://www.figma.com/design/Xl1lCZFt1kezELiIUX9VgE/project-1?node-id=0-1&t=I9TlpHwlQbN7RyZG-1",
      prototype: "https://www.figma.com/proto/Xl1lCZFt1kezELiIUX9VgE/project-1?page-id=0%3A1&node-id=0-400&viewport=129%2C37%2C0.13&t=XrLoaYaw2QQZsJax-1&scaling=min-zoom&content-scaling=fixed"
    },
    caseStudy: {
      heroImage: "/Farmeazyy2.png",
      showcaseImages: [
        "/Farmeazyy11.png",
        "/Farmeazyy2.png",
        "/Farmeazyy12.png",
        "/Farmeazyy3.png",
      ],
      overview: "FarmEazyy is a farmer-focused digital platform that bridges the gap between local farmers and industrial buyers or market vendors. Designed during Smart India Hackathon, the platform empowers small-scale farmers by providing a transparent and accessible way to list their produce, get real-time pricing, and connect directly with buyers â€” reducing middlemen and ensuring fair trade.<br /><br /> ðŸ›  Tools: Figma, React, Tailwind CSS  <br />ðŸŽ¨ Roles: UI/UX Design, Visual Branding",
      goal: "To build a transparent marketplace that empowers farmers with direct market access through a user-friendly web platform.",
      designProcess: "A 6-step funnel approach was used to guide the design from user journey mapping to final user testing.",
      designSystem: "A clean and modern design system focusing on clarity and ease-of-use. Typography features Post No Bills Colombo ExtraBold for headings and Poppins for body text."
    },
    x: 500,
    y: 100,
  },
  {
    title: "Lokallyâ€“Hyperlocal Delivery App",
    thumbnail: "/af.png",
    description: "Mobile-first local delivery solution",
    tech: ["Figma", "Prototyping", "Components"],
    tags: ["Figma", "Designathon"],
    colors: ["#4472BA", "#EE2D35", "#DBDBDB", "#EFF9FF", "#D2EBD3", "#65BF6C", "#404040"],
    links: {
      figma: "https://www.figma.com/design/JRtnmIT0Pz1t8E13fZ1i6s/Lokally?node-id=265-3658&t=lk64IZ5edoer1Lr0-1",
      prototype: "https://www.figma.com/proto/JRtnmIT0Pz1t8E13fZ1i6s/Lokally?page-id=1%3A2&node-id=265-3700&viewport=231%2C-70%2C0.11&t=JaBuuXzfkLN6HoYk-1&scaling=min-zoom&content-scaling=fixed"
    },
    caseStudy: {
      heroImage: "/a2.png",
      showcaseImages: [
        "/a3.png",
        "/a4.png",
        "/a5.png",
        "/a6.png",
      ],
      overview: "Lokally is a hyperlocal delivery app designed to help neighborhood sellers reach buyers within their vicinity. Created during a 48 hour Designathon, Lokally focuses on simplifying local commerce by making seller discovery, order placement, and delivery coordination seamless â€” with a mobile-first approach tailored for urban users.<br /><br />ðŸ›  Tools: Figma<br />ðŸŽ¨ Roles: UI/UX Design, Research, Prototyping",
      goal: "To streamline hyperlocal deliveries by bridging buyers and neighborhood sellers through a fast, reliable mobile platform.",
      designProcess: "A 7-step user-centric design process was implemented, starting from identifying user pain points to iterative prototyping and feedback.",
      designSystem: "A comprehensive design system featuring a vibrant color palette and Helvetica typography to ensure a clean, user-friendly interface."
    },
    x: 100,
    y: 400,
  },
  {
    title: "My Design Portfolio",
    thumbnail: "/p1.png",
    description: "Figma-style interactive portfolio site",
    tech: ["Figma", "Tailwind CSS", "React", "Framer Motion"],
    tags: ["Workspace", "Inception"],
    links: {
      figma: "https://figma.com/@saksham15"
    },
    caseStudy: {
      heroImage: "/p2.png",
      showcaseImages: [
        "/p3.png",
        "/p7.png",
        "/p8.png",
        "/p5.png",
      ],
      overview: "This portfolio isn't just a site â€” it's a playground of my design personality. Inspired by Figma's layout, I built it as an interactive design system to showcase not just what I've made, but how I think. Every scroll, card, and hover is intentional â€” from cursor interactions to section-based storytelling. <br /><br /> I'm Saksham Budhiraja â€” a UI/UX designer and frontend developer who thinks in frames and builds in pixels",
      goal: "To create a seamless, scrollable experience that reflects my style, skills, and storytelling.",
      designProcess: "The portfolio was built with a process that balanced structure, inspiration, and technical execution to create a unique, personal experience.",
      designSystem: "The entire site acts as its own design system, featuring Figma's color palette, Inter typeface, and a component-based architecture including the 3-panel layout and case study artboards."
    },
    x: 500,
    y: 400,
  },
];

const CursorAiIcon = () => (
  <span className="font-bold tracking-tighter text-2xl text-gray-300">
    C<span style={{color: '#1ABCFE'}}>A</span>
  </span>
);

const tools = [
  { name: "Figma", icon: <FaFigma className="text-pink-400" /> },
  { name: "React", icon: <FaReact className="text-sky-400" /> },
  { name: "GitHub", icon: <FaGithub className="text-white" /> },
  { name: "Cursor AI", icon: <CursorAiIcon /> },
  { name: "Sketch", icon: <SiSketch className="text-yellow-500" /> },
  { name: "Canva", icon: <SiCanva className="text-cyan-400" /> },
  { name: "Inkscape", icon: <SiInkscape className="text-white" /> },
  { name: "Tailwind CSS", icon: <FaTools className="text-cyan-300" /> },
];

const designProcessSteps = [
  { step: 1, title: "Research Pain Points", description: "Identifying challenges in existing civic apps", icon: FaMapMarkedAlt, color: "text-blue-300", iconColor: "text-blue-300" },
  { step: 2, title: "Define User Flow", description: "Mapping out the user journey", icon: BsDiagram3, color: "text-cyan-300", iconColor: "text-cyan-300" },
  { step: 3, title: "Design UI", description: "Creating a clean, card-based interface", icon: BsGrid1X2, color: "text-green-300", iconColor: "text-green-300" },
  { step: 4, title: "Build Components", description: "Developing responsive components", icon: BsPuzzle, color: "text-lime-300", iconColor: "text-lime-300" },
  { step: 5, title: "Focus on Accessibility", description: "Ensuring the app is usable for everyone", icon: FaUniversalAccess, color: "text-yellow-300", iconColor: "text-yellow-300" },
  { step: 6, title: "Implement Urgency Tagging", description: "Adding tags to prioritize urgent issues", icon: FaTag, color: "text-orange-300", iconColor: "text-orange-300" },
  { step: 7, title: "Smooth Complaint Tracking", description: "Streamlining the process for tracking", icon: FaTasks, color: "text-red-300", iconColor: "text-red-300" },
];

const farmEazyyDesignProcessSteps = [
    { step: 1, title: "Define User Journeys", description: "Mapping farmer and buyer interactions", icon: BsDiagram3, color: "text-blue-400", iconColor: "text-blue-400" },
    { step: 2, title: "Visualize Marketplace", description: "Designing a user-friendly interface", icon: BsGrid1X2, color: "text-green-400", iconColor: "text-green-400" },
    { step: 3, title: "Prioritize Accessibility", description: "Ensuring usability for all users", icon: FaUniversalAccess, color: "text-lime-400", iconColor: "text-lime-400" },
    { step: 4, title: "Develop UI Components", description: "Building consistent and responsive elements", icon: BsPuzzle, color: "text-yellow-400", iconColor: "text-yellow-400" },
    { step: 5, title: "Integrate Price Indicators", description: "Providing real-time pricing guidance", icon: FaTag, color: "text-orange-400", iconColor: "text-orange-400" },
    { step: 6, title: "Test with Users", description: "Conducting usability testing for improvements", icon: GoCheck, color: "text-red-400", iconColor: "text-red-400" },
];

const lokallyDesignProcessSteps = [
    { title: "Identify Urban Retail Pain Points", description: "Interviewed local sellers and buyers", icon: FaCommentDots, color: "text-red-400" },
    { title: "Map Dual User Flows", description: "Created separate flows for sellers and customers", icon: FaUsers, color: "text-orange-400" },
    { title: "Design a Card-first UI", description: "Developed a card-based product listing layout", icon: BsGrid1X2, color: "text-yellow-400" },
    { title: "Enable Location-based Filtering", description: "Integrated real-time location detection", icon: FaMapMarkedAlt, color: "text-green-400" },
    { title: "Simplify Checkout & Delivery Preferences", description: "Built a quick checkout experience", icon: FaShoppingCart, color: "text-cyan-400" },
    { title: "Incorporate Trust Signals", description: "Highlighted verified sellers and buyer ratings", icon: FaStar, color: "text-blue-400" },
    { title: "Prototype & Refine Based on Feedback", description: "Created interactive prototypes and tested them", icon: FaVial, color: "text-purple-400" },
];

const portfolioDesignProcessSteps = [
  { side: 'left', title: "Structure First", description: "Defined core components", icon: VscFileCode, color: "text-cyan-400" },
  { side: 'right', title: "Inspiration", description: "Took cues from Figma's interface", icon: FaFigma, color: "text-blue-400" },
  { side: 'left', title: "Code & Motion", description: "Built using React + Tailwind", icon: FaReact, color: "text-green-400" },
  { side: 'right', title: "System Thinking", description: "Created reusable design tokens", icon: BsDiagram3, color: "text-green-400" },
  { side: 'right', title: "Polish & Personality", description: "Added hover states and quirky touches", icon: FaStar, color: "text-yellow-400" },
];

const portfolioKeyFeatures = [
    { title: "Figma-Inspired UI", description: "A three-panel layout with a central canvas, inspired by professional design tools.", icon: FaFigma },
    { title: "Interactive Canvas", description: "The workspace is pannable and zoomable, mimicking an infinite design canvas.", icon: FaSearchPlus },
    { title: "Dynamic Side Panels", description: "Side panels adjust based on the selected content, providing context-aware information.", icon: BsGrid1X2 },
    { title: "Custom Cursor", description: "A custom Figma-style cursor enhances the thematic experience of the workspace.", icon: FaMousePointer },
];

const socials = [
  { name: "LinkedIn", icon: <FaLinkedin />, url: "https://www.linkedin.com/in/saksham-budhiraja-545b1028b/" },
  { name: "GitHub", icon: <FaGithub />, url: "https://github.com/sakshampro11" },
  { name: "Instagram", icon: <FaInstagram />, url: "https://www.instagram.com/saksham.pro._/?__pwa=1" },
  { name: "Email", icon: <SiGmail />, url: "mailto:budhirajasaksham6@gmail.com" },
];

const assetComponents = [
  {
    name: "Case Study Artboard",
    icon: VscSymbolFile,
    description: "The main container for detailed project walkthroughs.",
    variants: ["Default", "With Key Features", "With Design Process"],
  },
  {
    name: "Project Card",
    icon: BsPuzzle,
    description: "Interactive card to select and preview a project.",
    variants: ["Default", "Hover State", "Active"],
  },
  {
    name: "Info Panel",
    icon: BsGrid1X2,
    description: "Context-aware side panel for details and actions.",
    variants: ["Global About", "Project Details"],
  },
];

const figmaCursorSVG =
  "data:image/svg+xml,%3Csvg width='32' height='32' viewBox='0 0 32 32' fill='none' xmlns='http://www.w3.org/2000/svg'%3E%3Cpath d='M4 2L28 16L18 18L16 28L4 2Z' fill='black' stroke='white' stroke-width='3'/%3E%3C/svg%3E";

const customScrollbarStyle = document.createElement('style');
customScrollbarStyle.innerHTML = ``;

const style = document.createElement('style');
style.innerHTML = `.hide-scrollbar::-webkit-scrollbar { display: none; } .hide-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }`;
document.head.appendChild(style);

function ProjectsTabBar({ selectedProject, onBack }) {
  return (
    <div className="w-full flex items-center gap-2 px-2 py-0.5" style={{ height: 44 }}>
      {selectedProject !== null ? (
        <button onClick={onBack} className="flex items-center gap-2 text-[var(--text-primary)] px-3 py-1 rounded hover:bg-[var(--surface)] transition font-semibold" style={{ fontWeight: 600 }}>
          Projects
        </button>
      ) : (
        <span
          className="text-base font-medium text-[var(--text-primary)] px-3 py-1 rounded flex items-center gap-2 transition-all duration-300"
          style={{ background: 'var(--surface)', fontWeight: 600, borderBottom: '2px solid var(--text-primary)' }}
        >
          Projects
        </span>
      )}
    </div>
  );
}

export default function App() {
  const { theme, setTheme } = useTheme();
  const [selected, setSelected] = useState(null);
  const [tab, setTab] = useState("about");
  const [leftSidebarTab, setLeftSidebarTab] = useState('file');
  const [isMenuOpen, setIsMenuOpen] = useState(false);
  const [isLeftSidebarOpen, setIsLeftSidebarOpen] = useState(false);
  const [isRightSidebarOpen, setIsRightSidebarOpen] = useState(false);
  const [zoom, setZoom] = useState(1);
  const workspaceRef = useRef(null);
  const [showFakeCursor, setShowFakeCursor] = useState(true);
  const [cursorPos, setCursorPos] = useState({ x: 80, y: 80 });
  const [aboutFlipped, setAboutFlipped] = useState(false);
  const [linkCopied, setLinkCopied] = useState(false);
  const [workspaceBg, setWorkspaceBg] = useState('#1e1e1e');
  const [isSocialsOpen, setIsSocialsOpen] = useState(false);
  const [isResumeOpen, setIsResumeOpen] = useState(false);
  const [leftPanelWidth, setLeftPanelWidth] = useState(240);
  const [rightPanelWidth, setRightPanelWidth] = useState(320);
  const [isResizingLeft, setIsResizingLeft] = useState(false);
  const [isResizingRight, setIsResizingRight] = useState(false);
  const leftResizeRef = useRef(null);
  const rightResizeRef = useRef(null);

  // Add resize handlers
  const handleMouseDown = (side) => (e) => {
    e.preventDefault();
    if (window.innerWidth >= 768) { // Only allow resizing on desktop
      if (side === 'left') {
        setIsResizingLeft(true);
      } else {
        setIsResizingRight(true);
      }
    }
  };

  useEffect(() => {
    const handleMouseMove = (e) => {
      if (isResizingLeft) {
        const newWidth = Math.min(Math.max(e.clientX, 200), 400);
        setLeftPanelWidth(newWidth);
      } else if (isResizingRight) {
        // For right panel, calculate width from the left edge handle position
        const newWidth = Math.min(Math.max(window.innerWidth - e.clientX, 200), 400);
        setRightPanelWidth(newWidth);
      }
    };

    const handleMouseUp = () => {
      setIsResizingLeft(false);
      setIsResizingRight(false);
    };

    if (isResizingLeft || isResizingRight) {
      document.addEventListener('mousemove', handleMouseMove);
      document.addEventListener('mouseup', handleMouseUp);
    }

    return () => {
      document.removeEventListener('mousemove', handleMouseMove);
      document.removeEventListener('mouseup', handleMouseUp);
    };
  }, [isResizingLeft, isResizingRight]);

  // Add this effect after the resize effect
  useEffect(() => {
    setRightPanelWidth(selected === null ? 440 : 320);
  }, [selected]);

  const handleShare = () => {
    navigator.clipboard.writeText(window.location.href).then(() => {
      setLinkCopied(true);
      setTimeout(() => setLinkCopied(false), 2000);
    }).catch(err => {
      console.error('Failed to copy text: ', err);
    });
  };

  useEffect(() => {
    const workspace = workspaceRef.current;
    if (workspace) {
      workspace.style.cursor = `url(/poof.svg) 8 8, auto`;
    }
    return () => {
      if (workspace) workspace.style.cursor = "auto";
    };
  }, []);

  useEffect(() => {
    const workspace = workspaceRef.current;
    if (!workspace) return;
    function handleWheel(e) {
      if (e.ctrlKey || e.metaKey) {
        e.preventDefault();
        let nextZoom = zoom - e.deltaY * 0.001;
        nextZoom = Math.max(0.3, Math.min(2.5, nextZoom));
        setZoom(nextZoom);
      }
    }
    workspace.addEventListener("wheel", handleWheel, { passive: false });
    return () => workspace.removeEventListener("wheel", handleWheel);
  }, [zoom]);

  // Add this effect to reset the cursor animation when component mounts
  useEffect(() => {
    setShowFakeCursor(true);
  }, []);

  useEffect(() => {
    if (!showFakeCursor) return;
    // Adjust positions for centered layout
    const cardPositions = [
      { x: 120, y: 120 }, { x: 520, y: 120 },
      { x: 120, y: 420 }, { x: 520, y: 420 },
    ];
    const path = [{ x: 60, y: 60 }, ...cardPositions];
    let i = 0;
    setCursorPos(path[0]);
    const interval = setInterval(() => {
      i++;
      if (i >= path.length) i = 0;
      setCursorPos(path[i]);
    }, 800);
    const timeout = setTimeout(() => {
      setShowFakeCursor(false);
      clearInterval(interval);
    }, 3000);
    return () => {
      clearInterval(interval);
      clearTimeout(timeout);
    };
  }, [showFakeCursor]);

  return (
    <div className="min-h-screen flex flex-col font-sans" style={{ fontFamily: '"Space Grotesk", sans-serif', background: '#232323' }}>
      {/* Mobile Menu Buttons */}
      <button 
        onClick={() => setIsLeftSidebarOpen(true)}
        className="fixed top-4 left-4 z-50 md:hidden p-2 bg-[var(--surface)] rounded-lg border border-[var(--border)]"
      >
        <FaBars className="w-5 h-5 text-[var(--text-primary)]" />
      </button>

      <button
        onClick={() => setIsRightSidebarOpen(true)}
        className="fixed top-4 right-4 z-50 md:hidden p-2 bg-[var(--surface)] rounded-full border border-[var(--border)]"
      >
        <img src="/profile.JPG" alt="Profile" className="w-6 h-6 rounded-full object-cover" />
      </button>

      {/* Mobile Overlays */}
      {isLeftSidebarOpen && (
        <div 
          onClick={() => setIsLeftSidebarOpen(false)} 
          className="fixed inset-0 bg-black/30 z-40 md:hidden"
        />
      )}

      {isRightSidebarOpen && (
        <div 
          onClick={() => setIsRightSidebarOpen(false)} 
          className="fixed inset-0 bg-black/30 z-40 md:hidden"
        />
      )}

      <div className="flex flex-1 min-h-0">
        {/* Left Sidebar */}
        <aside 
          className={`fixed top-0 left-0 h-full z-40 bg-[var(--surface)] border-r border-[var(--border)] transition-transform duration-300 ease-in-out ${isLeftSidebarOpen ? 'translate-x-0' : '-translate-x-full'} md:translate-x-0`} 
          style={{ width: `${leftPanelWidth}px` }}
        >
          <div className="flex flex-col h-full relative">
            {/* Mobile Close Button */}
            <button 
              onClick={() => setIsLeftSidebarOpen(false)} 
              className="absolute top-4 right-4 text-[var(--text-secondary)] md:hidden"
            >
              <FaTimes size={20}/>
            </button>

            <div className="relative flex items-center justify-between p-3 border-b border-[var(--border)]">
              <button onClick={() => setIsMenuOpen(!isMenuOpen)} className="flex items-center gap-2">
                <BsPuzzle className="text-[var(--text-primary)] w-5 h-5" />
                <FaChevronDown className="w-4 h-4 text-[var(--text-secondary)]" />
              </button>
              
              <AnimatePresence>
                {isMenuOpen && (
                  <motion.div
                    initial={{ opacity: 0, y: -10 }}
                    animate={{ opacity: 1, y: 0 }}
                    exit={{ opacity: 0, y: -10 }}
                    className="absolute top-14 left-2 w-56 bg-[var(--surface)] border border-[var(--border)] rounded-lg shadow-xl z-50"
                  >
                    <div className="p-2">
                      <button 
                        onClick={() => { setTheme('light'); setIsMenuOpen(false); }}
                        className="w-full flex items-center justify-between px-3 py-2 text-sm rounded-md hover:bg-[var(--background)] text-[var(--text-primary)]"
                      >
                        <div className="flex items-center gap-2">
                          <FiSun className="w-5 h-5" />
                          <span>Light</span>
                        </div>
                        {theme === 'light' && <GoCheck className="w-5 h-5 text-green-500" />}
                      </button>
                      <button 
                        onClick={() => { setTheme('dark'); setIsMenuOpen(false); }}
                        className="w-full flex items-center justify-between px-3 py-2 text-sm rounded-md hover:bg-[var(--background)] text-[var(--text-primary)]"
                      >
                        <div className="flex items-center gap-2">
                          <FiMoon className="w-5 h-5" />
                          <span>Dark</span>
                        </div>
                        {theme === 'dark' && <GoCheck className="w-5 h-5 text-green-500" />}
                      </button>
                    </div>
                  </motion.div>
                )}
              </AnimatePresence>
            </div>

            <div className="p-4">
              <div className="flex items-center gap-2">
                <h1 className="text-lg font-bold text-[var(--text-primary)]">Portfolio</h1>
                <FaChevronDown className="w-4 h-4 text-[var(--text-secondary)]" />
              </div>
              <div className="flex items-center gap-2 mt-1">
                <span className="text-sm text-[var(--text-secondary)]">Drafts</span>
                <span className="px-2 py-0.5 text-xs font-semibold text-cyan-300 bg-cyan-500/20 rounded-md">Free</span>
              </div>
            </div>

            {/* Add resize handle */}
            <div
              ref={leftResizeRef}
              onMouseDown={handleMouseDown('left')}
              className="absolute top-0 right-0 w-2 h-full cursor-col-resize hover:bg-cyan-400 transition-colors duration-150 hidden md:block z-10"
              style={{ 
                opacity: isResizingLeft ? 1 : 0.3,
                background: isResizingLeft ? 'rgb(34 211 238)' : 'transparent'
              }}
            />
          </div>
        </aside>

        {/* Main Content */}
        <main className={`flex-1 flex flex-col items-center justify-start py-0 px-4 md:px-0 min-h-0 relative h-screen overflow-y-auto overflow-x-hidden custom-scrollbar bg-[var(--background)] ${selected === null ? 'pt-16 md:pt-0' : ''}`}>
          <div className="w-full sticky top-0 z-30 bg-[var(--background)]/80 backdrop-blur-sm border-b border-[var(--border)]">
            <ProjectsTabBar selectedProject={selected} onBack={() => setSelected(null)} />
          </div>

          {selected === null ? (
            <div>
              {/* Mobile View */}
              <div className="block md:hidden w-full space-y-12">
                <div className="bg-[var(--surface)] rounded-xl p-6">
                  <div className="flex items-center gap-4 mb-6">
                    <img src="/profile.jpg" alt="Profile" className="w-14 h-14 rounded-full border-2 border-[#A259FF] shadow-lg object-cover" />
                    <div>
                      <div className="text-xl font-bold" style={{ color: figmaColors[0] }}>Saksham Budhiraja</div>
                      <div className="text-sm text-[var(--text-secondary)]">UI UX Designer</div>
                    </div>
                  </div>
                  <div className="text-base text-[var(--text-secondary)]">
                    A UI/UX designer and frontend developer who thinks in frames and builds in pixels.
                  </div>
                </div>

                <div className="bg-[var(--surface)] rounded-xl p-6">
                  <h2 className="text-lg font-bold text-[var(--text-primary)] mb-4">Tools & Skills</h2>
                  <div className="grid grid-cols-3 gap-4">
                    {tools.map(tool => (
                      <div key={tool.name} className="flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-[var(--background)] border border-[var(--border)]">
                        <div className="text-3xl">{tool.icon}</div>
                        <span className="text-xs text-[var(--text-secondary)] text-center">{tool.name}</span>
                      </div>
                    ))}
                  </div>
                </div>

                <div className="space-y-6">
                  <h2 className="text-lg font-bold text-[var(--text-primary)]">Projects</h2>
                  {projects.map((project, idx) => (
                    <motion.div
                      key={project.title}
                      className="w-full bg-[var(--surface)] rounded-xl overflow-hidden border border-[var(--border)]"
                      initial={{ opacity: 0, y: 20 }}
                      animate={{ opacity: 1, y: 0 }}
                      transition={{ delay: idx * 0.1 }}
                      onClick={() => setSelected(idx)}
                    >
                      <div className="aspect-video bg-[var(--background)]">
                        <img src={project.thumbnail} alt={project.title} className="w-full h-full object-cover" />
                      </div>
                      <div className="p-4">
                        <h3 className="text-lg font-bold text-[var(--text-primary)]">{project.title}</h3>
                        <p className="text-sm text-[var(--text-secondary)] mt-1">{project.description}</p>
                        <div className="flex flex-wrap gap-2 mt-3">
                          {project.tags && project.tags.map((tag, i) => (
                            <span key={tag} className="px-2 py-0.5 rounded-full text-xs font-semibold" style={{ background: figmaColors[i % figmaColors.length], color: '#fff' }}>{tag}</span>
                          ))}
                        </div>
                      </div>
                    </motion.div>
                  ))}
                </div>
              </div>

              {/* Desktop View */}
              <div className="hidden md:block w-full">
                <div ref={workspaceRef} className="relative w-full flex-1 flex items-center justify-center">
                  <AnimatePresence>
                    {showFakeCursor && (
                      <motion.div
                        initial={{ opacity: 0 }}
                        animate={{ opacity: 1, x: cursorPos.x, y: cursorPos.y }}
                        exit={{ opacity: 0 }}
                        transition={{ type: "spring", stiffness: 100, damping: 15 }}
                        style={{ 
                          position: 'absolute', 
                          zIndex: 100, 
                          pointerEvents: 'none',
                          left: 0,
                          top: 0
                        }}
                      >
                        <svg width="36" height="36" viewBox="0 0 36 36" fill="none" style={{ filter: 'drop-shadow(0 2px 4px rgba(0,0,0,0.1))' }}>
                         <path d="M6 2L30 16L19 20L17 33L6 2Z" fill="#18181b" stroke="var(--surface)" strokeWidth="3"/>
                      </svg>
                      </motion.div>
                    )}
                  </AnimatePresence>
                  <motion.div
                    style={{ width: 1200, height: 800, position: 'relative', transform: `scale(${zoom})`, transformOrigin: 'center center', perspective: 1200, transition: 'transform 0.15s cubic-bezier(.4,2,.6,1)' }}
                    initial="hidden"
                    animate="visible"
                    variants={{ hidden: {}, visible: { transition: { staggerChildren: 0.18 } } }}
                  >
                    {projects.map((project, idx) => (
                      <motion.div
                        key={project.title}
                        className={`absolute group w-[320px] h-[240px] rounded-xl shadow-lg border-2 border-transparent cursor-pointer flex flex-col items-stretch p-0 bg-[var(--surface)]`}
                        style={{ left: project.x, top: project.y, transformStyle: "preserve-3d" }}
                        onClick={() => setSelected(idx)}
                        initial={{ y: 40, opacity: 0 }}
                        animate={{ y: 0, opacity: 1 }}
                        whileHover={{ y: -15, rotateX: 8, rotateY: -8, scale: 1.05, borderColor: 'var(--border)' }}
                        whileTap={{ scale: 1.02, y: -10, rotateX: 0, rotateY: 0, boxShadow: '0px 0px 30px rgba(128, 128, 128, 0.5)' }}
                        transition={{ type: 'spring', stiffness: 300, damping: 20, delay: idx * 0.1 }}
                      >
                        <div className="flex-1 rounded-t-xl overflow-hidden flex items-center justify-center bg-[var(--background)]">
                          <img src={project.thumbnail} alt={project.title} className="object-cover w-full h-full" />
                        </div>
                         <motion.div 
                           className="absolute inset-0 bg-black/60 flex items-center justify-center rounded-xl pointer-events-none"
                           initial={{opacity: 0}}
                           whileHover={{opacity: 1}}
                         >
                           <span className="text-white font-bold text-lg border-2 border-white rounded-lg px-4 py-2">View Project</span>
                         </motion.div>
                         <div className="flex flex-col gap-1 px-4 py-3 bg-[var(--surface)] rounded-b-xl border-t border-[var(--border)]">
                           <div className="flex items-center gap-2">
                             <div className="w-7 h-7 rounded-full bg-[var(--background)] flex items-center justify-center text-xs font-bold text-[var(--text-primary)]">{project.title[0]}</div>
                             <div className="flex-1 min-w-0">
                               <div className="truncate text-[var(--text-primary)] font-medium text-base">{project.title}</div>
                               <div className="truncate text-xs text-[var(--text-secondary)]">{project.description}</div>
                             </div>
                           </div>
                           <div className="flex flex-wrap gap-2 mt-2">
                             {project.tags && project.tags.map((tag, i) => (
                               <span key={tag} className="px-2 py-0.5 rounded-full text-xs font-semibold" style={{ background: figmaColors[i % figmaColors.length], color: '#fff', letterSpacing: 0.5 }}>{tag}</span>
                             ))}
                           </div>
                         </div>
                      </motion.div>
                    ))}
                  </motion.div>
                </div>
              </div>
            </div>
          ) : (
            <div>
              {/* Project Details View */}
              <div
                className="relative w-full flex-1 min-h-0 flex justify-center items-start custom-scrollbar"
                style={{ cursor: `url(/poof.svg) 8 8, auto` }}
              >
                <div className="w-[900px] min-h-[1200px] rounded-2xl shadow-lg my-12 flex flex-col px-12 py-10 relative bg-[var(--surface)]">
                  <button
                    onClick={() => setSelected(null)}
                    className="absolute top-6 left-6 z-10 w-10 h-10 flex items-center justify-center rounded-full bg-[var(--background)] border border-[var(--border)] text-[var(--text-secondary)] hover:text-orange-400 hover:bg-[var(--surface)] transition shadow-lg"
                    title="Back to Projects"
                  >
                    <FaArrowLeft size={20} />
                  </button>
                  <div className="flex flex-row gap-10 mb-10 mt-16">
                    <div className="flex-1 flex flex-col gap-4">
                      <div className="text-5xl font-extrabold text-[var(--text-primary)]">{projects[selected].title}</div>
                      <div className="text-xl text-[var(--text-primary)] font-semibold">{projects[selected].description}</div>
                      <div className="text-base text-[var(--text-primary)] font-bold mt-4">ABOUT</div>
                      <div className="text-sm text-[var(--text-secondary)]" dangerouslySetInnerHTML={{ __html: projects[selected].caseStudy.overview }}></div>
                      <div className="text-base text-[var(--text-primary)] font-bold mt-4">GOAL</div>
                      <div className="text-sm text-[var(--text-secondary)]">{projects[selected].caseStudy.goal}</div>
                    </div>
                    <div className="w-1/3">
                      {projects[selected].caseStudy.heroImage ? (
                        <img src={projects[selected].caseStudy.heroImage} alt={projects[selected].title} className="w-full h-auto object-cover rounded-lg shadow-lg" />
                      ) : (
                        <div className="bg-[var(--background)] w-full h-64 rounded-lg"></div>
                      )}
                    </div>
                  </div>

                  <div className="mb-10">
                    <div className="text-2xl font-bold text-[var(--text-primary)] mb-2">DESIGN PROCESS</div>
                    <div className="text-sm text-[var(--text-secondary)] mb-6">{projects[selected].caseStudy.designProcess}</div>
                    {projects[selected].title === "City Issue Reporter (Lokally)" ? (
                      <div className="relative">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                          {designProcessSteps.map((item, index) => (
                            <div key={item.step} className={`flex items-start p-4 rounded-lg bg-[var(--background)] transform ${index % 2 !== 0 ? 'md:translate-y-12' : ''}`}>
                              <div className="flex-shrink-0 mr-4">
                                <div className={`w-12 h-12 rounded-lg border-2 border-dashed border-[var(--border)] flex items-center justify-center`}>
                                  <item.icon className={`w-6 h-6 ${item.iconColor}`} />
                                </div>
                              </div>
                              <div>
                                <p className={`text-lg font-bold ${item.color}`}>{item.title}</p>
                                <p className="text-sm text-[var(--text-secondary)] mt-1">{item.description}</p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ) : projects[selected].title === "FarmEazyy" ? (
                      <div className="relative">
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-x-8 gap-y-4">
                          {farmEazyyDesignProcessSteps.map((item, index) => (
                            <div key={item.step} className={`flex items-start p-4 rounded-lg bg-[var(--background)] transform ${index % 2 !== 0 ? 'md:translate-y-12' : ''}`}>
                              <div className="flex-shrink-0 mr-4">
                                <div className={`w-12 h-12 rounded-lg border-2 border-dashed border-[var(--border)] flex items-center justify-center`}>
                                  <item.icon className={`w-6 h-6 ${item.iconColor}`} />
                                </div>
                              </div>
                              <div>
                                <p className={`text-lg font-bold ${item.color}`}>{item.title}</p>
                                <p className="text-sm text-[var(--text-secondary)] mt-1">{item.description}</p>
                              </div>
                            </div>
                          ))}
                        </div>
                      </div>
                    ) : projects[selected].title === "Lokallyâ€“Hyperlocal Delivery App" ? (
                      <div className="relative pl-8">
                        {lokallyDesignProcessSteps.map((item, index) => (
                          <div key={item.title} className="flex items-start mb-8">
                            <div className="absolute left-0 flex flex-col items-center">
                              <div className={`w-16 h-16 rounded-full flex items-center justify-center ${item.color.replace('text-', 'bg-')} bg-opacity-20`}>
                                <div className={`w-12 h-12 rounded-full flex items-center justify-center ${item.color.replace('text-', 'bg-')} bg-opacity-30`}>
                                  <item.icon className={`w-6 h-6 ${item.color}`} />
                                </div>
                              </div>
                              {index < lokallyDesignProcessSteps.length - 1 && <div className="w-0.5 h-12 bg-[var(--border)]" />}
                            </div>
                            <div className="ml-12 pl-8">
                              <p className={`text-lg font-bold ${item.color}`}>{item.title}</p>
                              <p className="text-sm text-[var(--text-secondary)] mt-1">{item.description}</p>
                            </div>
                          </div>
                        ))}
                      </div>
                    ) : projects[selected].title === "My Design Portfolio" ? (
                      <div className="relative py-8">
                        <div className="absolute left-1/2 -translate-x-1/2 h-full w-0.5 bg-[var(--border)]" />
                          <div className="space-y-12">
                            {portfolioDesignProcessSteps.map((item, index) => (
                              <div key={index} className="relative flex items-center">
                                {item.side === 'left' && (
                                  <div className="w-1/2 pr-16 text-right">
                                    <p className={`text-lg font-bold ${item.color}`}>{item.title}</p>
                                    <p className="text-sm text-[var(--text-secondary)] mt-1">{item.description}</p>
                                  </div>
                                )}
                                <div className="absolute left-1/2 -translate-x-1/2 w-12 h-12 bg-[var(--surface)] rounded-full border-2 border-[var(--border)] flex items-center justify-center z-10">
                                  <item.icon className={`w-6 h-6 ${item.color}`} />
                                </div>
                                {item.side === 'right' && (
                                  <div className="w-1/2 pl-16 ml-auto text-left">
                                    <p className={`text-lg font-bold ${item.color}`}>{item.title}</p>
                                    <p className="text-sm text-[var(--text-secondary)] mt-1">{item.description}</p>
                                  </div>
                                )}
                              </div>
                            ))}
                          </div>
                      </div>
                    ) : (
                      <div className="w-full h-[180px] bg-[var(--background)] rounded-lg flex items-center justify-center border border-[var(--border)] text-[var(--text-secondary)]">Design Process Placeholder</div>
                    )}
                  </div>

                  {projects[selected].title === 'My Design Portfolio' && (
                    <div className="my-12 pt-12">
                      <div className="text-2xl font-bold text-[var(--text-primary)] mb-8">KEY FEATURES</div>
                      <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                        {portfolioKeyFeatures.map((feature, index) => (
                            <motion.div 
                              key={feature.title} 
                              className="bg-[var(--background)] p-6 rounded-lg border border-[var(--border)]"
                              initial={{ opacity: 0, y: 20 }}
                              animate={{ opacity: 1, y: 0 }}
                              transition={{ delay: index * 0.1 }}
                            >
                              <div className="flex items-center gap-4">
                                <div className="w-12 h-12 flex-shrink-0 flex items-center justify-center rounded-lg bg-[var(--surface)]">
                                  <feature.icon className="w-6 h-6 text-cyan-400" />
                                </div>
                                <div>
                                  <h3 className="text-lg font-bold text-[var(--text-primary)]">{feature.title}</h3>
                                  <p className="text-sm text-[var(--text-secondary)]">{feature.description}</p>
                                </div>
                              </div>
                            </motion.div>
                        ))}
                      </div>
                    </div>
                  )}

                  <div className="my-12 pt-12">
                     <div className="text-2xl font-bold text-[var(--text-primary)] mb-4">UI SHOWCASE</div>
                     {projects[selected].caseStudy.showcaseImages && projects[selected].caseStudy.showcaseImages.length > 0 ? (
                        <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                          {projects[selected].caseStudy.showcaseImages.map((imgSrc, index) => (
                            <div key={index} className="bg-[var(--background)] aspect-video rounded-lg p-2 border border-[var(--border)]">
                              <img src={imgSrc} alt={`Showcase ${index + 1}`} className="w-full h-full object-cover rounded-md"/>
                            </div>
                          ))}
                        </div>
                     ) : (
                       <div className="grid grid-cols-1 md:grid-cols-2 gap-6">
                         <div className="bg-[var(--background)] aspect-video rounded-lg p-2 border border-[var(--border)]"><div className="w-full h-full bg-[var(--surface)] rounded-md flex items-center justify-center text-[var(--text-secondary)]">Image 1</div></div>
                         <div className="bg-[var(--background)] aspect-video rounded-lg p-2 border border-[var(--border)]"><div className="w-full h-full bg-[var(--surface)] rounded-md flex items-center justify-center text-[var(--text-secondary)]">Image 2</div></div>
                         <div className="bg-[var(--background)] aspect-video rounded-lg p-2 border border-[var(--border)]"><div className="w-full h-full bg-[var(--surface)] rounded-md flex items-center justify-center text-[var(--text-secondary)]">Image 3</div></div>
                         <div className="bg-[var(--background)] aspect-video rounded-lg p-2 border border-[var(--border)]"><div className="w-full h-full bg-[var(--surface)] rounded-md flex items-center justify-center text-[var(--text-secondary)]">Image 4</div></div>
                       </div>
                     )}
                   </div>

                   <div className="w-full h-px bg-[var(--border)] opacity-40 mb-10"></div>
                   
                   <div className="mb-4">
                     <div className="text-2xl font-bold text-[var(--text-primary)] mb-2">DESIGN SYSTEM</div>
                     <div className="flex flex-row gap-8">
                       <div className="flex flex-col gap-2">
                         <div className="text-sm font-semibold text-[var(--text-secondary)] mb-1">COLOR PALETTE</div>
                         <div className="flex flex-row gap-2 mb-2">
                           {(projects[selected].colors || figmaColors).map((c, i) => (
                             <span key={i} className="w-8 h-8 rounded-lg border border-[var(--border)]" style={{ background: c }}></span>
                           ))}
                         </div>
                         <div className="text-xs text-[var(--text-secondary)]">{(projects[selected].colors || figmaColors).join(' ')}</div>
                       </div>
                       <div className="flex flex-col gap-2 flex-1">
                         <div className="text-sm font-semibold text-[var(--text-secondary)] mb-1">TYPOGRAPHY</div>
                         {projects[selected].title === 'FarmEazyy' ? (
                           <div className="text-xs text-[var(--text-secondary)]">
                             <div><span className="font-semibold text-[var(--text-primary)]">Headings:</span> Post No Bills Colombo ExtraBold</div>
                             <div><span className="font-semibold text-[var(--text-primary)]">Body:</span> Poppins</div>
                           </div>
                         ) : projects[selected].title === 'Lokallyâ€“Hyperlocal Delivery App' ? (
                           <div className="text-xs text-[var(--text-secondary)]">
                             <div><span className="font-semibold text-[var(--text-primary)]">Font:</span> Helvetica</div>
                           </div>
                         ) : projects[selected].title === 'My Design Portfolio' ? (
                           <div className="text-xs text-[var(--text-secondary)]">
                             <div><span className="font-semibold text-[var(--text-primary)]">Font:</span> Inter</div>
                           </div>
                         ) : (
                           <div className="flex flex-row gap-4">
                             <div className="flex flex-col items-start">
                               <span className="text-2xl font-bold text-[var(--text-primary)]">Aa</span>
                               <span className="text-xs font-semibold text-[var(--text-primary)]">Typeface</span>
                               <span className="text-xs text-[var(--text-secondary)]">Space Grotesk</span>
                             </div>
                           </div>
                         )}
                       </div>
                       <div className="flex flex-col gap-2 flex-1">
                         {projects[selected].title === 'Lokallyâ€“Hyperlocal Delivery App' ? (
                           <>
                             <div className="text-sm font-semibold text-[var(--text-secondary)] mb-1">Delivery Systems</div>
                             <div className="text-xs text-[var(--text-secondary)] border-2 border-dashed border-[var(--border)] rounded-lg min-h-[60px] p-2">
                               Quick, Same Day and 24 hours
                             </div>
                           </>
                         ) : projects[selected].title === 'FarmEazyy' ? null : (
                           <>
                             <div className="text-sm font-semibold text-[var(--text-secondary)] mb-1">Card Layout (complaints)</div>
                             <div className="text-xs text-[var(--text-secondary)] border-2 border-dashed border-[var(--border)] rounded-lg min-h-[60px] p-2">
                               Reusable container with padding, corner radius and + NEW COMPLAINT Button
                             </div>
                           </>
                         )}
                         {projects[selected].title === 'My Design Portfolio' && (
                           <>
                             <div className="text-sm font-semibold text-[var(--text-secondary)] mb-1">Core Components</div>
                             <div className="text-xs text-[var(--text-secondary)] border-2 border-dashed border-[var(--border)] rounded-lg min-h-[60px] p-2">
                               3-Panel Layout, Case Study Artboards, Interactive Workspace
                             </div>
                           </>
                         )}
                       </div>
                     </div>
                   </div>
                 </div>
               </div>
             </div>
          )}
        </main>

        {/* Right Sidebar */}
        <aside 
          className={`fixed top-0 right-0 h-full z-40 border-l bg-[var(--surface)] border-[var(--border)] transition-transform duration-300 ease-in-out ${isRightSidebarOpen ? 'translate-x-0' : 'translate-x-full'} md:translate-x-0`} 
          style={{ width: `${rightPanelWidth}px` }}
        >
          {/* Add resize handle */}
          <div
            ref={rightResizeRef}
            onMouseDown={handleMouseDown('right')}
            className="absolute top-0 left-0 w-2 h-full cursor-col-resize hover:bg-cyan-400 transition-colors duration-150 hidden md:block z-10"
            style={{ 
              opacity: isResizingRight ? 1 : 0.3,
              background: isResizingRight ? 'rgb(34 211 238)' : 'transparent'
            }}
          />

          <div className="flex flex-col py-8 px-8 h-full relative">
            {/* Mobile Close Button */}
            <button 
              onClick={() => setIsRightSidebarOpen(false)} 
              className="absolute top-4 right-4 text-[var(--text-secondary)] md:hidden"
            >
              <FaTimes size={20}/>
            </button>
            {selected === null ? (
              <>
                <div className="absolute top-9 right-8">
                  <button onClick={handleShare} className="relative group p-2 rounded-full hover:bg-[var(--background)] transition-colors">
                    <FaShareAlt className="text-[var(--text-secondary)] group-hover:text-[var(--text-primary)] transition-colors" />
                    <AnimatePresence>
                      {linkCopied && (
                        <motion.div
                          initial={{ opacity: 0, y: 10 }}
                          animate={{ opacity: 1, y: 0 }}
                          exit={{ opacity: 0, y: 10 }}
                          className="absolute top-full mt-2 right-0 w-max px-3 py-1.5 bg-[var(--surface)] text-[var(--text-primary)] text-xs rounded-md shadow-lg border border-[var(--border)]"
                        >
                          Link Copied!
                        </motion.div>
                      )}
                    </AnimatePresence>
                  </button>
                </div>
                <div className="flex items-center gap-4 mb-6">
                  <img src="/profile.jpg" alt="Profile" className="w-14 h-14 rounded-full border-2 border-[#A259FF] shadow-lg object-cover" />
                  <div>
                    <div className="text-xl font-bold" style={{ color: figmaColors[0] }}>Saksham Budhiraja</div>
                    <div className="text-sm text-[var(--text-secondary)]">UI UX Designer</div>
                  </div>
                </div>
                <div className="flex gap-2 mb-4">
                  <button onClick={() => setTab('about')} className={`px-4 py-2 rounded-t-lg font-semibold text-sm transition ${tab === 'about' ? 'bg-[var(--background)] text-[var(--text-primary)]' : 'bg-transparent text-[var(--text-secondary)] hover:bg-[var(--background)]'}`}>About Me</button>
                  <button onClick={() => setTab('tools')} className={`px-4 py-2 rounded-t-lg font-semibold text-sm transition ${tab === 'tools' ? 'bg-[var(--background)] text-[var(--text-primary)]' : 'bg-transparent text-[var(--text-secondary)] hover:bg-[var(--background)]'}`}>Tools</button>
                </div>
                {tab === 'about' ? (
                  <div className="relative mb-6 min-h-[120px]">
                    <div className="absolute top-3 right-4 z-10">
                      <button
                        onClick={() => setAboutFlipped(f => !f)}
                        className="rounded-full bg-[var(--surface)] hover:bg-[#1ABCFE] text-[#1ABCFE] hover:text-white p-2 shadow-md border border-[#1ABCFE] transition-transform active:scale-90"
                        title="Flip Card"
                        style={{ outline: 'none' }}
                      >
                        <svg width="22" height="22" fill="none" viewBox="0 0 24 24">
                          <rect x="4" y="6" width="16" height="12" rx="3" stroke="currentColor" strokeWidth="2" fill="var(--surface)" />
                          <path d="M8 12h8" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                          <path d="M12 8v8" stroke="currentColor" strokeWidth="2" strokeLinecap="round"/>
                          <path d="M4 12c0-4 16-4 16 0" stroke="currentColor" strokeWidth="1.5" strokeDasharray="2 2"/>
                        </svg>
                      </button>
                    </div>
                    <div className="perspective-[1200px]">
                      <AnimatePresence mode="wait" initial={false}>
                        {!aboutFlipped ? (
                          <motion.div
                            key="about-front"
                            initial={{ rotateY: 90, opacity: 0 }}
                            animate={{ rotateY: 0, opacity: 1 }}
                            exit={{ rotateY: -90, opacity: 0 }}
                            transition={{ duration: 0.6, ease: [0.4, 0.2, 0.2, 1] }}
                            className="rounded-2xl p-6 shadow-lg border text-[var(--text-primary)] min-h-[200px] bg-gradient-to-r from-[var(--surface)] to-[#1ABCFE11] border-[#1ABCFE]"
                            style={{ boxShadow: '0 2px 24px 0 #1ABCFE22', backfaceVisibility: 'hidden', position: 'absolute', width: '100%' }}
                          >
                            <span className="text-2xl mr-2 align-middle">ðŸ‘‹</span>
                            <span className="text-lg font-bold text-[var(--text-primary)]">Hi, I'm Saksham Budhiraja</span>
                            <div className="mt-2 text-base text-[var(--text-secondary)]">
                              A UI/UX designer and frontend developer who thinks in frames and builds in pixels.
                            </div>
                            <div className="mt-3 text-sm text-[var(--text-secondary)]">
                              From designing collaborative platforms like <span className="font-semibold text-[#1ABCFE]">Skollab</span> to civic tools like <span className="font-semibold text-[#A259FF]">City Issue Reporter</span>, I enjoy solving real-world problems through user-centered design. I work with tools like <span className="font-semibold text-[#1ABCFE]">Figma</span>, <span className="font-semibold text-[#61DAFB]">React</span>, and I'm always exploring how design systems and interactivity can enhance product experiences.
                            </div>
                            <div className="mt-3 text-sm text-[var(--text-secondary)]">
                              Currently pursuing a B.Tech in CSE, I believe in learning by building â€” and iterating with purpose.
                            </div>
                          </motion.div>
                        ) : (
                          <motion.div
                            key="about-back"
                            initial={{ rotateY: -90, opacity: 0 }}
                            animate={{ rotateY: 0, opacity: 1 }}
                            exit={{ rotateY: 90, opacity: 0 }}
                            transition={{ duration: 0.6, ease: [0.4, 0.2, 0.2, 1] }}
                            className="rounded-2xl p-6 shadow-lg border text-[var(--text-primary)] min-h-[200px] bg-gradient-to-r from-[var(--surface)] to-[#A259FF11] border-[#A259FF] flex flex-col gap-2"
                            style={{ boxShadow: '0 2px 24px 0 #A259FF22', backfaceVisibility: 'hidden', position: 'absolute', width: '100%' }}
                          >
                            <div className="text-lg font-bold text-[var(--text-primary)] mb-2">Component Name: <span className="font-semibold text-[#1ABCFE]">Saksham Budhiraja</span></div>
                            <div className="text-base font-semibold text-[#A259FF] mb-2">Role: UI/UX Designer + Developer Handoff</div>
                            <div className="text-base font-semibold text-[#1ABCFE] mb-1">Skills:</div>
                            <ul className="list-disc list-inside text-[var(--text-secondary)] ml-2">
                              <li>Design Systems</li>
                              <li>Interactive Prototypes</li>
                              <li>Web Accessibility</li>
                              <li>React + UI Engineering</li>
                            </ul>
                          </motion.div>
                        )}
                      </AnimatePresence>
                    </div>
                  </div>
                ) : (
                  <div className="grid grid-cols-3 gap-4 mb-6 p-1">
                    {tools.map(tool => (
                      <motion.div 
                        key={tool.name} 
                        className="flex flex-col items-center justify-center gap-2 p-4 rounded-xl bg-[var(--background)] border border-transparent hover:border-cyan-400 cursor-pointer"
                        whileHover={{ scale: 1.08, y: -5 }}
                        transition={{ type: 'spring', stiffness: 300, damping: 10 }}
                      >
                        <div className="text-3xl h-8 flex items-center">{tool.icon}</div>
                        <span className="text-xs text-[var(--text-secondary)] text-center font-medium h-4">{tool.name}</span>
                      </motion.div>
                    ))}
                  </div>
                )}
              </div>
            ) : (
              <div>
                <div className="text-xl font-bold mb-6 text-[var(--text-primary)]">Project Details</div>
                <div className="mb-6">
                  <div className="text-base font-semibold text-[var(--text-secondary)] mb-2">Tech Stack</div>
                  <div className="flex flex-wrap gap-2">
                    {projects[selected].tech.map((t, i) => (
                      <span key={t} className="px-2 py-1 rounded text-xs" style={{ background: figmaColors[i % figmaColors.length], color: '#fff' }}>{t}</span>
                    ))}
                  </div>
                </div>
                <div className="mb-6">
                  <div className="text-base font-semibold text-[var(--text-secondary)] mb-2">Color Palette</div>
                  <div className="flex gap-2">
                    {(projects[selected].colors || figmaColors).map((c, i) => (
                      <span key={i} className="w-6 h-6 rounded-full border-2 border-[var(--surface)]" style={{ background: c }}></span>
                    ))}
                  </div>
                </div>
                <div className="mt-auto pt-6 border-t border-[var(--border)]">
                  <div className="text-base font-semibold text-[var(--text-secondary)] mb-2">Links</div>
                  <div className="flex flex-col gap-2">
                    <a 
                      href={projects[selected].links?.figma || "#"}
                      target="_blank" 
                      rel="noopener noreferrer" 
                      className="flex items-center justify-center gap-2 w-full bg-[var(--background)] hover:bg-[var(--border)] text-[var(--text-primary)] font-bold py-2 px-4 rounded-md transition"
                    >
                      <FaFigma /> Figma
                    </a>
                    <a 
                      href={projects[selected].links?.prototype || "#"} 
                      target="_blank" 
                      rel="noopener noreferrer" 
                      className="flex items-center justify-center gap-2 w-full bg-[var(--background)] hover:bg-[var(--border)] text-[var(--text-primary)] font-bold py-2 px-4 rounded-md transition"
                    >
                      <FaLink /> Prototype
                    </a>
                    {projects[selected].links?.live ? (
                       <a 
                        href={projects[selected].links.live}
                        target="_blank" 
                        rel="noopener noreferrer" 
                        className="flex items-center justify-center gap-2 w-full bg-green-600 hover:bg-green-500 text-white font-bold py-2 px-4 rounded-md transition"
                      >
                        <FaExternalLinkAlt /> Website
                      </a>
                    ) : (
                      <button 
                        disabled 
                        className="flex items-center justify-center gap-2 w-full bg-[var(--background)] text-[var(--text-secondary)] font-bold py-2 px-4 rounded-md cursor-not-allowed"
                      >
                        Website (not live)
                      </button>
                    )}
                  </div>
                </div>
              </>
            )}
          </div>
        </aside>
      </div>

      {/* Bottom Fixed Bar */}
      <div className="fixed left-1/2 -translate-x-1/2 bottom-6 z-50 flex gap-12 border rounded-2xl shadow-2xl px-16 py-3 items-center bg-[var(--surface)] border-[var(--border)]" style={{ minWidth: 520 }}>
        <a href="/" className="flex flex-row items-center gap-2 px-4 py-2 rounded-lg font-medium transition" style={{ color: figmaColors[3], background: 'transparent' }}>
          <FaUser size={22} />
          <span className="text-base">Portfolio</span>
        </a>
        <button onClick={() => setIsResumeOpen(true)} className="flex flex-row items-center gap-2 px-4 py-2 rounded-lg font-medium transition text-[var(--text-primary)]" style={{ background: 'transparent' }}>
          <FaFileAlt size={22} />
          <span className="text-base">Resume</span>
        </button>
        <button onClick={() => setIsSocialsOpen(true)} className="flex flex-row items-center gap-2 px-4 py-2 rounded-lg font-medium transition text-[var(--text-primary)]" style={{ background: 'transparent' }}>
          <FaLink size={22} />
          <span className="text-base">Socials</span>
        </button>
      </div>

      {/* Resume Modal */}
      <AnimatePresence>
        {isResumeOpen && (
          <motion.div
            initial={{ y: "100%" }}
            animate={{ y: 0 }}
            exit={{ y: "100%" }}
            transition={{ type: 'spring', stiffness: 400, damping: 40 }}
            className="fixed bottom-0 left-0 right-0 h-24 bg-[var(--surface)] border-t border-[var(--border)] z-50 flex items-center justify-center"
          >
            <button
              disabled
              className="flex items-center gap-3 bg-gray-500 text-white font-bold py-3 px-6 rounded-lg transition text-lg cursor-not-allowed"
            >
              <FaFileAlt /> Resume (Coming Soon)
            </button>
            <button 
              onClick={() => setIsResumeOpen(false)}
              className="absolute top-1/2 -translate-y-1/2 right-8 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors text-2xl"
            >
              <FaTimes />
            </button>
          </motion.div>
        )}
      </AnimatePresence>

      {/* Socials Modal */}
      <AnimatePresence>
        {isSocialsOpen && (
          <motion.div 
            initial={{ y: "100%" }}
            animate={{ y: 0 }}
            exit={{ y: "100%" }}
            transition={{ type: 'spring', stiffness: 400, damping: 40 }}
            className="fixed bottom-0 left-0 right-0 h-24 bg-[var(--surface)] border-t border-[var(--border)] z-50 flex items-center justify-center"
          >
            <div className="flex gap-12 items-center">
              {socials.map(social => (
                <a 
                  key={social.name}
                  href={social.url} 
                  target="_blank" 
                  rel="noopener noreferrer" 
                  className="text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-transform duration-300 hover:scale-110 text-3xl"
                  title={social.name}
                >
                  {social.icon}
                </a>
              ))}
            </div>
            <button 
              onClick={() => setIsSocialsOpen(false)}
              className="absolute top-1/2 -translate-y-1/2 right-8 text-[var(--text-secondary)] hover:text-[var(--text-primary)] transition-colors text-2xl"
            >
              <FaTimes />
            </button>
          </motion.div>
        )}
      </AnimatePresence>
    </div>
  );
}